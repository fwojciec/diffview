{"id":"diffview-0o8","title":"Context cancellation support","description":"## Problem\nThe Viewer.View method accepts a context parameter but doesn't use it. This means there's no way to cancel a running viewer externally.\n\n## Entrypoints\n- bubbletea/viewer.go:93 (View method)\n\n## Solution\nAdd tea.WithContext(ctx) to the program options:\n```go\np := tea.NewProgram(m,\n    tea.WithAltScreen(),\n    tea.WithMouseCellMotion(),\n    tea.WithContext(ctx),\n)\n```\n\n## Validation\n- [ ] Context cancellation terminates the viewer\n- [ ] Test covers cancellation behavior\n- [ ] make validate passes","notes":"COMPLETED: Context cancellation support\n- Added tea.WithContext(ctx) to program options\n- Added ViewerOption functional options pattern for testing\n- Test verifies viewer exits when context is cancelled\n\nKEY_DECISIONS:\n- Added WithProgramOptions() for injecting custom IO in tests\n- This enables testing without requiring a TTY","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T20:35:25.013463-08:00","updated_at":"2025-12-23T20:55:39.68024-08:00","closed_at":"2025-12-23T20:55:39.680244-08:00","dependencies":[{"issue_id":"diffview-0o8","depends_on_id":"diffview-z57","type":"blocks","created_at":"2025-12-23T20:35:32.158933-08:00","created_by":"daemon"}]}
{"id":"diffview-1mu","title":"Add word-level diff highlighting within changed lines","description":"## Problem\nWhen a line changes slightly, the entire line is highlighted. Users must manually compare old/new lines to spot the actual change. Critical for reviewing small edits buried in long lines.\n\n## Solution\nHighlight the specific words/characters that changed within modified lines:\n```\n-function calculate(x, y) {\n+function calculate(x, y, z) {\n                       ^^^  ← these chars get extra highlight\n```\n\n## Implementation\n1. During rendering, detect consecutive delete+add line pairs\n2. Run character or word-level diff algorithm (Myers or similar)\n3. Apply layered styling: base deleted/added style + brighter foreground for changed segments\n4. Consider a new package for word diffing logic\n\n## Complexity\nHigh - requires diffing algorithm for inline changes. Consider:\n- github.com/sergi/go-diff for diff algorithm\n- Word-based vs character-based granularity\n- Performance for large files\n\n## Entrypoints\n- bubbletea/viewer.go:254-268 (line rendering)\n- New package: worddiff/ or inline diff logic\n\n## Validation\n- [ ] Changed segments within lines are visually distinct\n- [ ] Works for both additions and deletions\n- [ ] Handles multiple changes per line\n- [ ] Performance acceptable for large diffs\n- [ ] make validate passes","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-23T23:51:20.633449-08:00","updated_at":"2025-12-24T09:38:53.473574-08:00","closed_at":"2025-12-24T09:38:53.47358-08:00"}
{"id":"diffview-1y9","title":"Add background colors for added/deleted lines","description":"## Problem\nCurrently only text color changes for added/deleted lines. This makes scanning large diffs slow - the eye must read each line to notice changes rather than catching blocks of color.\n\n## Solution\nAdd subtle background tints to entire lines:\n- Added lines: subtle green background (e.g., #2d3f2d on dark theme)\n- Deleted lines: subtle red background (e.g., #3f2d2d on dark theme)\n\nLike GitHub/GitLab diff views where changed lines have colored backgrounds.\n\n## Implementation\n- Update ColorPair usage in styles to include backgrounds for Added/Deleted\n- In renderDiffWithPositions(), pad lines to terminal width so background extends full width\n- May need to pass terminal width to renderer or use a fixed large width\n\n## Entrypoints\n- lipgloss/theme.go:25 (DarkTheme - add backgrounds)\n- lipgloss/theme.go:49 (LightTheme - add backgrounds)  \n- bubbletea/viewer.go:254-268 (line rendering - ensure full-width)\n\n## Validation\n- [ ] Added lines have subtle green background extending full width\n- [ ] Deleted lines have subtle red background extending full width\n- [ ] Context lines have no background (or terminal default)\n- [ ] Colors work well on both dark and light themes\n- [ ] make validate passes","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-23T23:51:10.161456-08:00","updated_at":"2025-12-24T08:12:49.132207-08:00","closed_at":"2025-12-24T08:12:49.132215-08:00"}
{"id":"diffview-51z","title":"Add colorblind-friendly theme using blue/orange palette","description":"## Problem\nCurrent red/green color scheme is problematic for ~8% of men with deuteranopia/protanopia (red-green colorblindness). Added and deleted lines may be indistinguishable.\n\n## Solution\nAdd a colorblind-friendly theme using blue/orange (or cyan/peach) which have:\n- Very different perceived lightness\n- Work across all common colorblindness types\n- Blue is perceived similarly by almost everyone\n\n## Implementation\n```go\nfunc ColorblindTheme() *Theme {\n    return \u0026Theme{\n        styles: diffview.Styles{\n            Added: diffview.ColorPair{\n                Foreground: \"#74c7ec\", // Cyan/sky blue\n            },\n            Deleted: diffview.ColorPair{\n                Foreground: \"#fab387\", // Orange/peach\n            },\n            Context: diffview.ColorPair{\n                Foreground: \"#6c7086\", // Muted gray\n            },\n            HunkHeader: diffview.ColorPair{\n                Foreground: \"#cba6f7\", // Mauve (distinct from both)\n            },\n            FileHeader: diffview.ColorPair{\n                Foreground: \"#f9e2af\",\n                Background: \"#313244\",\n            },\n        },\n    }\n}\n```\n\n## References\n- https://davidmathlogic.com/colorblind/\n- https://www.smashingmagazine.com/2024/02/designing-for-colorblindness/\n\n## Entrypoints\n- lipgloss/theme.go (add ColorblindTheme function)\n\n## Validation\n- [ ] ColorblindTheme() function exists and returns valid theme\n- [ ] Colors are distinguishable in colorblind simulators\n- [ ] Test with deuteranopia/protanopia simulation tools\n- [ ] make validate passes","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-23T23:55:40.144182-08:00","updated_at":"2025-12-23T23:55:40.144182-08:00"}
{"id":"diffview-5tv","title":"Dim context lines for better change visibility","description":"## Problem\nContext lines are fairly visible (#cdd6f4) - similar prominence to changed lines. Changes don't pop as much as they could.\n\n## Solution\nReduce context line brightness significantly:\n- Current: #cdd6f4 (light gray)\n- Proposed: #6c7086 (muted gray)\n\nContext should fade into background so changes stand out.\n\n## Implementation\nSimple color change in theme definitions.\n\n## Entrypoints\n- lipgloss/theme.go:34 (DarkTheme context color)\n- lipgloss/theme.go:58 (LightTheme context color)\n\n## Validation\n- [ ] Context lines are visibly dimmer than changed lines\n- [ ] Still readable, not invisible\n- [ ] Changes pop more visually\n- [ ] make validate passes","status":"open","priority":4,"issue_type":"feature","created_at":"2025-12-23T23:51:21.305346-08:00","updated_at":"2025-12-23T23:51:21.305346-08:00"}
{"id":"diffview-6rk","title":"Add status bar with scroll position, navigation info, and key hints","description":"## Problem\nThe diff viewer has no persistent UI showing where you are in the diff or how to navigate. Users must remember keybindings and have no sense of position in large diffs.\n\n## Solution\nAdd a status bar at the bottom showing:\n- Current file name and position (file 2/5)\n- Current hunk position (hunk 3/8)\n- Scroll percentage or Top/Bot indicator\n- Key hints: j/k:scroll n/N:hunk ]/[:file q:quit\n\n## Implementation\nUse Bubble Tea header/footer pattern from bubble-tea skill:\n- Modify View() to use JoinVertical with viewport + statusBarView()\n- Add currentFileIndex()/currentHunkIndex() methods (binary search positions)\n- Adjust viewport.Height in WindowSizeMsg to account for status bar height\n- Use lipgloss for styling with muted colors for less important info\n\n## Entrypoints\n- bubbletea/viewer.go:140 (View method)\n- bubbletea/viewer.go:123 (WindowSizeMsg handler)\n\n## Validation\n- [ ] Status bar visible at bottom of screen\n- [ ] Shows current file name and file X/Y position\n- [ ] Shows hunk X/Y position\n- [ ] Shows scroll percentage (or Top/Bot at edges)\n- [ ] Shows condensed key hints\n- [ ] Updates as user scrolls/navigates\n- [ ] make validate passes","notes":"COMPLETED: Status bar implementation with file/hunk positions, scroll indicator, and key hints\nIN_PROGRESS: Self-review\nKEY_DECISIONS: Used lipgloss.JoinVertical for layout, binary search for position tracking","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-23T23:51:09.919553-08:00","updated_at":"2025-12-24T00:22:22.956209-08:00","closed_at":"2025-12-24T00:22:22.956211-08:00"}
{"id":"diffview-7u3","title":"Diff renderer with styling","description":"## Problem\nThe viewer doesn't render diffs properly. It just dumps raw `line.Content` with no formatting.\n\n## Missing Features\n- File headers (`--- a/file`, `+++ b/file`)\n- Hunk headers (`@@ -1,5 +1,10 @@`)\n- Line prefixes (`+`/`-`/` ` for added/deleted/context)\n- Colors from the styling system (`lipgloss/theme.go` exists but isn't used)\n\n## Entrypoints\n- `bubbletea/viewer.go:renderDiffWithPositions()` - current renderer\n- `lipgloss/theme.go` - theme/colors to apply\n- `diffview.go` - domain types (Line.Type, Styles, etc.)\n\n## Validation\n- [ ] File headers shown with yellow/background styling\n- [ ] Hunk headers shown with blue styling\n- [ ] Added lines green with + prefix\n- [ ] Deleted lines red with - prefix\n- [ ] Context lines gray with space prefix\n- [ ] make validate passes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T22:31:49.164312-08:00","updated_at":"2025-12-23T23:12:11.854847-08:00","closed_at":"2025-12-23T23:12:11.854847-08:00","close_reason":"Implemented full diff rendering with styling:\n- File headers (--- a/..., +++ b/...) with yellow/dark background\n- Hunk headers (@@ ... @@) with blue styling\n- Added lines (+) in green\n- Deleted lines (-) in red  \n- Context lines ( ) in gray\n- Fixed double line spacing bug (closed diffview-dgu)\n- All tests pass, make validate passes","dependencies":[{"issue_id":"diffview-7u3","depends_on_id":"diffview-lzy","type":"blocks","created_at":"2025-12-23T22:32:08.460312-08:00","created_by":"daemon"}]}
{"id":"diffview-99k","title":"Add high-contrast theme for maximum visibility","description":"## Problem\nCatppuccin-inspired pastel colors prioritize aesthetics over contrast. Some users need higher contrast for visibility, especially in bright environments or with visual impairments.\n\n## Solution\nAdd a high-contrast theme with bold, saturated colors:\n- Pure or near-pure hues\n- Maximum lightness difference between elements\n- Stark backgrounds for changed lines\n\n## Implementation\n```go\nfunc HighContrastTheme() *Theme {\n    return \u0026Theme{\n        styles: diffview.Styles{\n            Added: diffview.ColorPair{\n                Foreground: \"#00ff00\", // Pure green\n            },\n            Deleted: diffview.ColorPair{\n                Foreground: \"#ff4444\", // Bright red\n            },\n            Context: diffview.ColorPair{\n                Foreground: \"#888888\", // Medium gray (dim)\n            },\n            HunkHeader: diffview.ColorPair{\n                Foreground: \"#00ffff\", // Cyan\n            },\n            FileHeader: diffview.ColorPair{\n                Foreground: \"#ffff00\", // Yellow\n                Background: \"#333333\",\n            },\n        },\n    }\n}\n```\n\n## Entrypoints\n- lipgloss/theme.go (add HighContrastTheme function)\n\n## Validation\n- [ ] HighContrastTheme() function exists\n- [ ] Colors are highly saturated and distinct\n- [ ] Passes WCAG AAA contrast requirements\n- [ ] make validate passes","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-23T23:55:40.355118-08:00","updated_at":"2025-12-23T23:55:40.355118-08:00"}
{"id":"diffview-ant","title":"Main wiring","description":"cmd/diffview/main.go - stdin detection, parser + viewer wiring, error handling, exit codes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T18:49:12.187088-08:00","updated_at":"2025-12-23T22:25:18.355404-08:00","closed_at":"2025-12-23T22:25:18.355408-08:00","dependencies":[{"issue_id":"diffview-ant","depends_on_id":"diffview-lzy","type":"parent-child","created_at":"2025-12-23T18:49:42.436068-08:00","created_by":"daemon"},{"issue_id":"diffview-ant","depends_on_id":"diffview-w0d","type":"blocks","created_at":"2025-12-23T18:49:53.79042-08:00","created_by":"daemon"},{"issue_id":"diffview-ant","depends_on_id":"diffview-m9i","type":"blocks","created_at":"2025-12-23T18:49:53.868288-08:00","created_by":"daemon"}]}
{"id":"diffview-ci2","title":"Audit codebase for manual line width calculations","description":"## Problem\nDuring diffview-1y9 implementation, we discovered that using `len(string)` for line width calculations is incorrect for multi-byte Unicode characters. The fix was to use `lipgloss.Width()` which handles display width correctly.\n\n## Action Items\n- [ ] Search codebase for `len(` patterns that might be calculating display widths\n- [ ] Replace with `lipgloss.Width()` where appropriate\n- [ ] Update bubbletea skill documentation with this important consideration\n\n## Context\n- `len(string)` counts bytes, not display characters\n- CJK characters are double-width (2 display cells) but 3 bytes each\n- Emoji can be 4 bytes but 2 display cells\n- `lipgloss.Width()` uses go-runewidth internally to handle these correctly\n\n## Validation\n- [ ] No remaining incorrect `len()` usage for display width\n- [ ] make validate passes","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-24T08:13:29.055683-08:00","updated_at":"2025-12-24T08:13:29.055683-08:00"}
{"id":"diffview-dgu","title":"Fix double line spacing in viewer","description":"## Problem\nThe viewer shows double line spacing between lines. Likely caused by `line.Content` already including trailing newline AND renderer adding another `\\n`.\n\n## Entrypoints\n- `bubbletea/viewer.go:renderDiffWithPositions()` line 172-173\n- Check what go-gitdiff returns in `line.Line`\n\n## Validation\n- [ ] Lines display with normal single spacing\n- [ ] make validate passes","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-23T22:31:56.438468-08:00","updated_at":"2025-12-23T23:11:08.087573-08:00","closed_at":"2025-12-23T23:11:08.087573-08:00","close_reason":"Fixed by trimming trailing newlines from parser content in renderDiffWithPositions","dependencies":[{"issue_id":"diffview-dgu","depends_on_id":"diffview-7u3","type":"blocks","created_at":"2025-12-23T22:32:08.381891-08:00","created_by":"daemon"}]}
{"id":"diffview-dn2","title":"Investigate syntax highlighting for diff content","description":"## Problem\nDiff content is currently displayed with line-level coloring (added/deleted/context) but no syntax highlighting for the actual code. This makes it harder to read and understand code changes, especially for complex diffs.\n\n## Investigation Scope\nThis is a research task to evaluate options before implementation:\n\n### Questions to Answer\n1. **Library options**: What Go libraries exist for syntax highlighting?\n   - chroma (github.com/alecthomas/chroma) - used by Hugo, Goldmark\n   - Others?\n\n2. **Integration approach**: How to layer syntax highlighting with diff styling?\n   - Apply syntax first, then diff background?\n   - Performance implications for large diffs?\n\n3. **Language detection**: How to detect the language for highlighting?\n   - File extension from diff headers\n   - Content-based detection fallback?\n\n4. **Terminal compatibility**: True color vs 256-color vs 16-color\n   - How does chroma handle different terminal capabilities?\n   - Interaction with lipgloss color profiles?\n\n5. **Theme coordination**: How to make syntax colors work with diff backgrounds?\n   - Need syntax themes that look good on green/red/neutral backgrounds\n   - Dark vs light theme considerations\n\n### Deliverables\n- [ ] Document findings in issue notes\n- [ ] Recommend approach with trade-offs\n- [ ] Create implementation tasks if viable\n\n## Context\n- Current diff viewer uses lipgloss for styling\n- Background colors for added/deleted lines already implemented\n- Must handle Unicode correctly (lipgloss.Width)","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-24T08:18:49.906619-08:00","updated_at":"2025-12-24T08:18:49.906619-08:00"}
{"id":"diffview-drc","title":"Styling system","description":"Theme, Styles, ColorPair types. DefaultTheme with diff coloring (added/deleted/context). Light/dark support structure.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T18:49:11.761233-08:00","updated_at":"2025-12-23T21:16:58.733579-08:00","closed_at":"2025-12-23T21:16:58.733583-08:00","dependencies":[{"issue_id":"diffview-drc","depends_on_id":"diffview-lzy","type":"parent-child","created_at":"2025-12-23T18:49:42.201597-08:00","created_by":"daemon"},{"issue_id":"diffview-drc","depends_on_id":"diffview-z57","type":"blocks","created_at":"2025-12-23T18:49:53.553227-08:00","created_by":"daemon"}]}
{"id":"diffview-e72","title":"Verify context cancellation in viewer","description":"## Problem\nContext is passed to `tea.WithContext(ctx)` but we should verify it actually cancels the viewer when the context is cancelled.\n\n## Entrypoints\n- `bubbletea/viewer.go:View()` line 207-218\n- `bubbletea/viewer_test.go:TestViewer_ContextCancellation` - existing test\n\n## Validation\n- [ ] Verify existing test actually tests cancellation properly\n- [ ] Add integration test if needed\n- [ ] make validate passes","notes":"COMPLETED:\n- Reviewed existing TestViewer_ContextCancellation test\n- Enhanced test to verify context.Canceled error is returned\n- Added TestViewer_ContextAlreadyCancelled test for pre-cancelled context edge case\n- make validate passes\n\nFINDINGS:\n- Context cancellation works correctly via tea.WithContext(ctx)\n- Bubble Tea returns context.Canceled when context is cancelled\n- Both runtime cancellation and pre-cancelled context cases work properly","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T22:32:02.245551-08:00","updated_at":"2025-12-23T22:54:46.757667-08:00","closed_at":"2025-12-23T22:54:46.757671-08:00"}
{"id":"diffview-gkp","title":"Add CLI flag to select theme","description":"## Problem\nNo way to select a theme at runtime. Users must use whatever theme is compiled as default.\n\n## Solution\nAdd a `--theme` flag to select from available themes:\n```bash\ngit diff | diffview --theme=colorblind\ngit diff | diffview --theme=high-contrast\ngit diff | diffview --theme=light\ngit diff | diffview --theme=dark  # default\n```\n\n## Implementation\n1. Add theme registry mapping names to theme constructors\n2. Add --theme flag in cmd/diffview/main.go\n3. Pass selected theme to bubbletea.NewModelWithStyles()\n4. Consider auto-detection of light/dark terminal background\n\n## Entrypoints\n- cmd/diffview/main.go (add flag parsing)\n- lipgloss/theme.go (add theme registry/lookup)\n\n## Dependencies\nShould come after colorblind and high-contrast themes exist.\n\n## Validation\n- [ ] --theme flag accepted\n- [ ] Invalid theme names produce helpful error\n- [ ] Each registered theme can be selected\n- [ ] Default remains dark theme\n- [ ] make validate passes","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-23T23:55:40.550811-08:00","updated_at":"2025-12-23T23:55:40.550811-08:00","dependencies":[{"issue_id":"diffview-gkp","depends_on_id":"diffview-51z","type":"blocks","created_at":"2025-12-23T23:55:48.220677-08:00","created_by":"daemon"},{"issue_id":"diffview-gkp","depends_on_id":"diffview-99k","type":"blocks","created_at":"2025-12-23T23:55:48.2993-08:00","created_by":"daemon"}]}
{"id":"diffview-hel","title":"Refactor width handling for cleaner testing","description":"## Problem\nCurrent width handling requires sending WindowSizeMsg before positions are computed, making tests awkward:\n```go\nm := bubbletea.NewModel(diff)\nupdated, _ := m.Update(tea.WindowSizeMsg{Width: 80, Height: 24})\nm = updated.(bubbletea.Model)\n```\n\nThis is a hack - the abstraction should make testing easy and logical.\n\n## Solution\nDesign the Model so that:\n- Positions can be accessed without requiring WindowSizeMsg first\n- Width-dependent rendering is cleanly separated from position tracking\n- Tests don't need special setup to verify positions\n\n## Options to explore\n1. Separate position computation from rendering (positions don't depend on width)\n2. Lazy computation with sensible defaults\n3. Builder pattern that makes dependencies explicit\n\n## Entrypoints\n- bubbletea/viewer.go: Model struct, NewModel, renderDiffWithPositions\n\n## Validation\n- [ ] Tests can check positions without WindowSizeMsg hack\n- [ ] Width-based rendering still works correctly\n- [ ] make validate passes","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-24T11:26:12.540892-08:00","updated_at":"2025-12-24T11:39:20.012594-08:00","closed_at":"2025-12-24T11:39:20.012601-08:00"}
{"id":"diffview-icx","title":"Add visual separators between files","description":"## Problem\nIn multi-file diffs, files blend together. Hard to see where one file ends and another begins when scrolling quickly.\n\n## Solution\nAdd visual breathing room between files:\n```\n────────────────────────────────────\n--- a/pkg/foo.go\n+++ b/pkg/foo.go\n```\n\n## Implementation\n- Add separator line before each file header (except first)\n- Use box-drawing character ─ repeated to terminal width\n- Or use lipgloss border on file header block\n- Muted color so it doesn't compete with content\n\n## Entrypoints\n- bubbletea/viewer.go:232-241 (file header rendering)\n\n## Validation\n- [ ] Visual separator appears between files\n- [ ] No separator before first file\n- [ ] Separator spans reasonable width\n- [ ] Styling is subtle/muted\n- [ ] make validate passes","notes":"COMPLETED: Added visual separators between files\n- Added FileSeparator to diffview.Styles struct\n- Updated lipgloss/theme.go for DarkTheme and LightTheme\n- Updated bubbletea/viewer.go default styles\n- Implemented separator rendering in renderDiffWithPositions\n- Separator uses box-drawing character ─ (U+2500) at 80 chars width\n- No separator before first file\n- Updated position tracking tests to account for separator line\n\nVALIDATION: make validate passes","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-23T23:51:20.870131-08:00","updated_at":"2025-12-24T11:08:54.166069-08:00","closed_at":"2025-12-24T11:08:54.166076-08:00"}
{"id":"diffview-lzy","title":"Milestone 1: Diff Pager","description":"A competent git diff | diffview pager with proper domain types, parsing, and navigation. Foundation for future semantic/AI features.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-23T18:48:52.458455-08:00","updated_at":"2025-12-23T22:58:56.11045-08:00","closed_at":"2025-12-23T22:58:56.11045-08:00","close_reason":"All 7 child tasks completed: domain types, parser, viewer scaffold, main wiring, styling system, hunk navigation, keybindings"}
{"id":"diffview-m9i","title":"Hunk navigation","description":"Track hunkPositions during render. Implement n/N (next/prev hunk), ]/[ (next/prev file) jumping.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T18:49:12.044884-08:00","updated_at":"2025-12-23T21:59:28.76102-08:00","closed_at":"2025-12-23T21:59:28.761024-08:00","dependencies":[{"issue_id":"diffview-m9i","depends_on_id":"diffview-lzy","type":"parent-child","created_at":"2025-12-23T18:49:42.358068-08:00","created_by":"daemon"},{"issue_id":"diffview-m9i","depends_on_id":"diffview-z57","type":"blocks","created_at":"2025-12-23T18:49:53.712404-08:00","created_by":"daemon"}]}
{"id":"diffview-npu","title":"Domain types","description":"Root package with Diff, Hunk, Line types and Parser, Viewer interfaces. No external dependencies per Ben Johnson pattern.","notes":"COMPLETED: Domain types (Diff, FileDiff, Hunk, Line) and interfaces (Parser, Viewer)\nIN_PROGRESS: Self-review\nNEXT: Code review and finish\nKEY_DECISIONS: Used io/fs.FileMode for file modes, context.Context for Viewer cancellation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T18:48:57.465717-08:00","updated_at":"2025-12-23T19:33:23.952374-08:00","closed_at":"2025-12-23T19:33:23.952375-08:00","dependencies":[{"issue_id":"diffview-npu","depends_on_id":"diffview-lzy","type":"parent-child","created_at":"2025-12-23T18:49:41.957753-08:00","created_by":"daemon"}]}
{"id":"diffview-sfm","title":"Add gutter symbols for line type indicators","description":"## Problem\nLine type is indicated only by +/- prefix and color. A dedicated gutter column with symbols would create cleaner visual columns.\n\n## Solution\nAdd a gutter column with box-drawing indicators:\n```\n│+│  added line content\n│-│  deleted line content\n│ │  context line content\n```\n\n## Implementation\n- Add gutter column between line numbers (if present) and content\n- Use box-drawing characters for clean lines\n- Color the +/- symbols to match line type\n- Muted border color\n\n## Entrypoints\n- bubbletea/viewer.go:254-268 (line rendering)\n\n## Dependencies\nConsider implementing after line numbers feature for consistent gutter design.\n\n## Validation\n- [ ] Gutter column with │+│, │-│, │ │ indicators\n- [ ] Symbols colored to match line type\n- [ ] Clean vertical alignment\n- [ ] make validate passes","status":"open","priority":4,"issue_type":"feature","created_at":"2025-12-23T23:51:21.521389-08:00","updated_at":"2025-12-23T23:51:21.521389-08:00","dependencies":[{"issue_id":"diffview-sfm","depends_on_id":"diffview-svh","type":"blocks","created_at":"2025-12-23T23:51:29.978448-08:00","created_by":"daemon"}]}
{"id":"diffview-svh","title":"Add line numbers in gutter column","description":"## Problem\nNo line numbers shown - users can't reference specific lines or correlate with their editor. Essential for code review workflows.\n\n## Solution\nAdd a gutter column showing old/new line numbers:\n```\n  12    14  │  context line\n  13     -  │- deleted line\n   -    15  │+ added line\n```\n\n## Implementation\n- Track line numbers during rendering (increment from Hunk.OldStart/NewStart)\n- Use lipgloss.JoinHorizontal to compose: lineNumStyle + separator + content\n- Line number style: right-aligned, fixed width, muted color\n- Show '-' for lines that don't exist on that side\n\n## Entrypoints\n- bubbletea/viewer.go:210-277 (renderDiffWithPositions - add gutter rendering)\n- diffview/styles.go (may need LineNumber ColorPair)\n\n## Validation\n- [ ] Old and new line numbers shown in gutter\n- [ ] Numbers increment correctly per line type\n- [ ] Deleted lines show number on left, '-' on right\n- [ ] Added lines show '-' on left, number on right\n- [ ] Context lines show both numbers\n- [ ] Gutter has muted styling, doesn't distract from content\n- [ ] make validate passes","notes":"COMPLETED: Line number gutter implementation\n- Added LineNumber ColorPair to Styles type\n- Added formatGutter and formatLineNum helper functions\n- Modified renderDiffWithPositions to prepend gutter to each line\n- Added tests for line number rendering\n- Dark theme uses #6c7086 (muted gray)\n- Light theme uses #9ca0b0 (lighter muted gray)\n\nIN_PROGRESS: Self-review\n\nKEY_DECISIONS:\n- Gutter width is 4 chars per column (old/new)\n- Format: '   1    2 │+content' with pipe separator\n- Using '-' for missing line numbers (added/deleted lines)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-23T23:51:20.396538-08:00","updated_at":"2025-12-24T08:54:57.478112-08:00","closed_at":"2025-12-24T08:54:57.478119-08:00"}
{"id":"diffview-w0d","title":"Parser implementation","description":"gitdiff/ package using bluekeyes/go-gitdiff. Parses unified diff, flattens file-centric to hunk-centric, computes line numbers.","notes":"COMPLETED: Parser implementation with go-gitdiff\n- Created gitdiff/ package with Parser type\n- Implements diffview.Parser interface\n- Parses unified diff format, handles all file operations (add/delete/modify/rename/copy)\n- Computes line numbers for old and new files\n- Handles binary files, no-newline-at-EOF markers\n- 8 passing tests covering all major scenarios\n\nKEY_DECISIONS:\n- Package named 'gitdiff' after the dependency (Ben Johnson pattern)\n- go-gitdiff strips a/b prefixes from paths (library behavior, not added back)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T18:49:11.479258-08:00","updated_at":"2025-12-23T20:18:47.669586-08:00","closed_at":"2025-12-23T20:18:47.669589-08:00","dependencies":[{"issue_id":"diffview-w0d","depends_on_id":"diffview-lzy","type":"parent-child","created_at":"2025-12-23T18:49:42.042751-08:00","created_by":"daemon"},{"issue_id":"diffview-w0d","depends_on_id":"diffview-npu","type":"blocks","created_at":"2025-12-23T18:49:53.383597-08:00","created_by":"daemon"}]}
{"id":"diffview-xjy","title":"Enhance file headers with change statistics","description":"## Problem\nFile headers only show path. No quick way to see how much changed in each file without reading through all hunks.\n\n## Solution\nEnhanced file header showing change stats:\n```\n── pkg/service/handler.go ─────────────────── +15 -8 ──\n```\n\n## Implementation\n- Count added/deleted lines per file from hunks\n- Format header with path + stats\n- Use full-width styling with box-drawing characters\n- Bold or more prominent styling than current\n\n## Entrypoints\n- bubbletea/viewer.go:232-241 (file header rendering)\n- May need helper to count changes from []Hunk\n\n## Validation\n- [ ] File headers show +N -M change counts\n- [ ] Counts are accurate per file\n- [ ] Header styling is prominent but not overwhelming\n- [ ] Works with file separators feature\n- [ ] make validate passes","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-23T23:51:21.091989-08:00","updated_at":"2025-12-23T23:51:21.091989-08:00"}
{"id":"diffview-xtn","title":"Keybindings","description":"KeyMap type, DefaultKeyMap with vim-style navigation. Multi-key sequence handling (gg) via pendingKey state.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T18:49:11.903201-08:00","updated_at":"2025-12-23T21:36:02.98577-08:00","closed_at":"2025-12-23T21:36:02.985775-08:00","dependencies":[{"issue_id":"diffview-xtn","depends_on_id":"diffview-lzy","type":"parent-child","created_at":"2025-12-23T18:49:42.27919-08:00","created_by":"daemon"},{"issue_id":"diffview-xtn","depends_on_id":"diffview-z57","type":"blocks","created_at":"2025-12-23T18:49:53.633992-08:00","created_by":"daemon"}]}
{"id":"diffview-z57","title":"Viewer scaffold","description":"bubbletea/ package with basic Model, viewport integration, stdin reading, quit handling. Minimal working pager.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T18:49:11.622236-08:00","updated_at":"2025-12-23T20:33:37.027674-08:00","closed_at":"2025-12-23T20:33:37.027676-08:00","dependencies":[{"issue_id":"diffview-z57","depends_on_id":"diffview-lzy","type":"parent-child","created_at":"2025-12-23T18:49:42.12409-08:00","created_by":"daemon"},{"issue_id":"diffview-z57","depends_on_id":"diffview-npu","type":"blocks","created_at":"2025-12-23T18:49:53.469895-08:00","created_by":"daemon"}]}
{"id":"diffview-z85","title":"Add GitHub-style theme matching familiar diff colors","description":"## Problem\nMany developers are accustomed to GitHub's diff colors. Offering a familiar option reduces cognitive switching.\n\n## Solution\nAdd a theme matching GitHub's diff color scheme:\n- Added: green text on light green background\n- Deleted: red text on light red/pink background\n- Familiar to most developers\n\n## Implementation\nExtract colors from GitHub's CSS or use approximations:\n```go\nfunc GithubDarkTheme() *Theme {\n    return \u0026Theme{\n        styles: diffview.Styles{\n            Added: diffview.ColorPair{\n                Foreground: \"#3fb950\", // GitHub green\n                Background: \"#1b4721\", // Dark green bg\n            },\n            Deleted: diffview.ColorPair{\n                Foreground: \"#f85149\", // GitHub red\n                Background: \"#5d1a1a\", // Dark red bg\n            },\n            // ...\n        },\n    }\n}\n```\n\n## Entrypoints\n- lipgloss/theme.go\n\n## Validation\n- [ ] GithubDarkTheme() exists\n- [ ] Colors reasonably match GitHub's diff view\n- [ ] make validate passes","status":"open","priority":4,"issue_type":"feature","created_at":"2025-12-23T23:55:40.771208-08:00","updated_at":"2025-12-23T23:55:40.771208-08:00"}
